<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QP Craft Mini</title>
    <style>
        body { font-family: sans-serif; background-color: #f4f4f9; color: #333; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1, h2 { text-align: center; color: #4a4a4a; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"] { width: 95%; padding: 10px; border-radius: 4px; border: 1px solid #ddd; }
        button { display: block; width: 100%; padding: 12px; background-color: #007BFF; color: white; border: none; border-radius: 4px; font-size: 16px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        #loader { text-align: center; display: none; margin-top: 20px; }
        .question-card { border: 1px solid #eee; padding: 15px; margin-top: 15px; border-radius: 5px; background: #fafafa; }
        .question-card p { margin: 0 0 10px 0; }
        .question-card ul { margin: 0; padding-left: 20px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>QP Craft - Mini</h1>
        
        <h2>Add a New Question</h2>
        <div id="addQuestionForm">
            <div class="form-group">
                <label for="subject">Subject:</label>
                <input type="text" id="subject" placeholder="e.g., Physics">
            </div>
            <div class="form-group">
                <label for="questionText">Question:</label>
                <input type="text" id="questionText" placeholder="Enter the question text">
            </div>
            <div class="form-group">
                <label>Options (Enter 4 options):</label>
                <input type="text" id="option1" placeholder="Option 1">
                <input type="text" id="option2" placeholder="Option 2" style="margin-top:5px;">
                <input type="text" id="option3" placeholder="Option 3" style="margin-top:5px;">
                <input type="text" id="option4" placeholder="Option 4" style="margin-top:5px;">
            </div>
            <div class="form-group">
                <label for="correctAnswer">Correct Answer:</label>
                <input type="text" id="correctAnswer" placeholder="Enter the correct answer text exactly as in options">
            </div>
            <button onclick="addQuestion()">Add Question</button>
        </div>

        <hr style="margin: 30px 0;">

        <h2>All Questions</h2>
        <div id="loader">Loading questions...</div>
        <div id="questionsList"></div>
    </div>

    <!-- Firebase SDK Scripts -->
    <script type="module">
        // Import functions from the Firebase SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

        // Your web app's Firebase configuration (Ye code aapne provide kiya hai)
        const firebaseConfig = {
          apiKey: "AIzaSyDx41mcczcSV7DcYHL20DMj0VMqQUsB0Qo",
          authDomain: "qp-craft.firebaseapp.com",
          projectId: "qp-craft",
          storageBucket: "qp-craft.firebasestorage.app",
          messagingSenderId: "358117125763",
          appId: "1:358117125763:web:463ed1f3e492a4bd8c35b6"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Global functions to be accessible by HTML
        window.addQuestion = async function() {
            const subject = document.getElementById('subject').value.trim();
            const questionText = document.getElementById('questionText').value.trim();
            const options = [
                document.getElementById('option1').value.trim(),
                document.getElementById('option2').value.trim(),
                document.getElementById('option3').value.trim(),
                document.getElementById('option4').value.trim()
            ];
            const correctAnswer = document.getElementById('correctAnswer').value.trim();

            if (!subject || !questionText || options.includes('') || !correctAnswer) {
                alert('Please fill all the fields.');
                return;
            }

            try {
                const docRef = await addDoc(collection(db, "questions"), {
                    subject: subject,
                    questionText: questionText,
                    options: options,
                    correctAnswer: correctAnswer,
                    createdAt: new Date()
                });
                alert('Question added successfully!');
                document.getElementById('addQuestionForm').reset();
                fetchQuestions(); // Refresh the list
            } catch (e) {
                console.error("Error adding document: ", e);
                alert('Error adding question. Check console for details.');
            }
        }

        async function fetchQuestions() {
            const questionsListDiv = document.getElementById('questionsList');
            const loader = document.getElementById('loader');
            
            questionsListDiv.innerHTML = '';
            loader.style.display = 'block';

            const querySnapshot = await getDocs(collection(db, "questions"));
            
            loader.style.display = 'none';

            if (querySnapshot.empty) {
                questionsListDiv.innerHTML = '<p>No questions found. Add one above!</p>';
                return;
            }

            querySnapshot.forEach((doc) => {
                const data = doc.data();
                const card = document.createElement('div');
                card.className = 'question-card';

                let optionsHTML = '<ul>';
                data.options.forEach(opt => {
                    optionsHTML += `<li>${opt}</li>`;
                });
                optionsHTML += '</ul>';

                card.innerHTML = `
                    <p><strong>Subject:</strong> ${data.subject}</p>
                    <p><strong>Q:</strong> ${data.questionText}</p>
                    ${optionsHTML}
                    <p><strong>Answer:</strong> ${data.correctAnswer}</p>
                `;
                questionsListDiv.appendChild(card);
            });
        }

        // Fetch questions when page loads
        document.addEventListener('DOMContentLoaded', fetchQuestions);

    </script>

</body>
</html>